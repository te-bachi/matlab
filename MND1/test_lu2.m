
clear;
clc;

%{
A = [
  2.00000000     -1.00000000     -3.00000000      3.00000000    ;
  4.00000000      0.00000000     -3.00000000      1.00000000    ;
  6.00000000      1.00000000     -1.00000000      6.00000000    ;
 -2.00000000     -5.00000000      4.00000000      1.00000000    ;
];

b = [
          1.00000000;
         -8.00000000;
        -16.00000000;
        -12.00000000;
];


[ L, U, P] = lu(A);
L
y = lr_forward(L, b);
x = lr_backward(U, y);
x
%}

%{
L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  2.00000000      1.00000000      0.00000000      0.00000000    ;
  3.00000000      1.00000000      1.00000000      0.00000000    ;
 -1.00000000     -5.00000000     -4.00000000      1.00000000    ;
];

U = [
  2.00000000     -1.00000000     -3.00000000      3.00000000    ;
  0.00000000      3.00000000      3.00000000     -5.00000000    ;
  0.00000000      0.00000000      2.00000000      5.00000000    ;
  0.00000000      0.00000000      0.00000000     25.00000000    ;
];

%}

%{
L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  2.00000000      1.00000000      0.00000000      0.00000000    ;
  3.00000000      1.33333333      1.00000000      0.00000000    ;
 -1.00000000     -2.00000000      1.75000000      1.00000000    ;
];
U = [
  2.00000000     -1.00000000     -3.00000000      3.00000000    ;
  0.00000000      3.00000000      3.00000000     -5.00000000    ;
  0.00000000      0.00000000      4.00000000      3.66666667    ;
  0.00000000      0.00000000      0.00000000    -12.41666667    ;
];
%}

%{
L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  2.00000000      1.00000000      0.00000000      0.00000000    ;
  1.92857143      0.85714286      1.00000000      0.00000000    ;
 -0.75000000     -1.50000000      2.04166667      1.00000000    ;
];
U = [
  0.22222222     -0.11111111     -0.33333333      0.33333333    ;
  0.00000000      0.33333333      0.33333333     -0.55555556    ;
  0.00000000      0.00000000      0.28571429      0.26190476    ;
  0.00000000      0.00000000      0.00000000     -1.03472222    ;
];

L*U
%}

%{

L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  2.00000000      1.00000000      0.00000000      0.00000000    ;
  4.00000000      2.00000000      1.00000000      0.00000000    ;
  6.00000000      4.00000000      2.00000000      1.00000000    ;
];
U = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  0.00000000      1.00000000      0.00000000      0.00000000    ;
  0.00000000      0.00000000      1.00000000      0.00000000    ;
  0.00000000      0.00000000      0.00000000      1.00000000    ;
];

L*U
ans =

     1     0     0     0
     2     1     0     0
     4     2     1     0
     6     4     2     1
%}

%{
L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  0.33333333      1.00000000      0.00000000      0.00000000    ;
  0.66666667      1.00000000      1.00000000      0.00000000    ;
  0.16666667      0.50000000     -0.00000000      1.00000000    ;
];
U = [
  6.00000000      4.00000000      2.00000000      1.00000000    ;
  0.00000000     -0.66666667     -0.33333333     -0.16666667    ;
  0.00000000      0.00000000     -0.50000000     -0.25000000    ;
  0.00000000      0.00000000      0.00000000     -0.50000000    ;
];
L*U
L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  0.33333333      1.00000000      0.00000000      0.00000000    ;
  0.66666667      1.00000000      1.00000000      0.00000000    ;
  0.16666667      0.50000000     -0.00000000      1.00000000    ;
];
U = [
  6.00000000      4.00000000      2.00000000      1.00000000    ;
  0.00000000     -0.66666667     -0.33333333     -0.16666667    ;
  0.00000000      0.00000000     -0.50000000     -0.25000000    ;
  0.00000000      0.00000000      0.00000000     -0.50000000    ;
];
%}

A = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  2.00000000      1.00000000      0.00000000      0.00000000    ;
  4.00000000      2.00000000      1.00000000      0.00000000    ;
  6.00000000      4.00000000      2.00000000      1.00000000    ;
];
b = [
          1.00000000;
          3.00000000;
          5.00000000;
          7.00000000;
];
[L U P] = lu(A)
y = lr_forward(L, P*b);
x = lr_backward(U, y);
x

%{
L = [
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  0.16666667      1.00000000      0.00000000      0.00000000    ;
  0.33333333      0.50000000      1.00000000      0.00000000    ;
  0.66666667      1.00000000     -0.00000000      1.00000000    ;
];
U = [
  6.00000000      4.00000000      2.00000000      1.00000000    ;
  0.00000000     -0.66666667     -0.33333333     -0.16666667    ;
  0.00000000      0.00000000     -0.50000000     -0.25000000    ;
  0.00000000      0.00000000      0.00000000     -0.50000000    ;
];
P = [
  0.00000000      0.00000000      0.00000000      1.00000000    ;
  1.00000000      0.00000000      0.00000000      0.00000000    ;
  0.00000000      1.00000000      0.00000000      0.00000000    ;
  0.00000000      0.00000000      1.00000000      0.00000000    ;
];

inv(P)*L*U
%}