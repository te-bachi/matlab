
clear;
clc;

%% Messungen
mess_x   = [ -11.00;    % 1
             -9.00;     % 2
             -7.00;     % 3
             -5.00;     % 4
             -3.00;     % 5
             -1.00;     % 6
              1.00;     % 7
              3.00;     % 8
              5.00;     % 9
              7.00;     % 10
              9.00;     % 11
             11.00;     % 12
             13.00;     % 13
             15.00;     % 14
             17.00;     % 15
             19.00]';   % 16
         
mess_y   = [  -0.49;    % 1
              -1.86;    % 2
              -4.93;    % 3
              -9.02;    % 4
             -10.91;    % 5
              -8.25;    % 6
              -3.47;    % 7
               0.29;    % 8
               4.25;    % 9
               8.98;    % 10
              10.90;    % 11
               8.36;    % 12
               4.28;    % 13
               1.51;    % 14
               0.38;    % 15
               0.07 ]'; % 16
  

scatter(mess_x, mess_y);
axis([-11 19 -12 12]);
hold on;

%% Modell mit numerisch berechneten Parametern x0, sigma, a und b
%f = @(x, x0, sigma, a, b) exp(-((x - x0).^2)/sigma) .* (a .* (x - x0).^3 + b .* (x - x0));
f = @(x, x0, sigma, a, b) exp(-((x - x0).^2)/sigma) .*...
                         (a .* (x - x0).^3 + b .* (x - x0));

x     = linspace(-11, 19);
x0    =   2.82847;
sigma =  28.989;
a     =   0.127884;
b     =   1.69936;

y = f(x, x0, sigma, a, b);

plot(x, y);
